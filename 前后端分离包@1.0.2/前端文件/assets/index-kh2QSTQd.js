var q=Object.defineProperty,L=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var N=(r,n,a)=>n in r?q(r,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[n]=a,v=(r,n)=>{for(var a in n||(n={}))H.call(n,a)&&N(r,a,n[a]);if(V)for(var a of V(n))Q.call(n,a)&&N(r,a,n[a]);return r},B=(r,n)=>L(r,G(n));import{r as d,u as A,o as D,c as R,w as t,a as J,b as $,F as X,G as Y,p as Z,d as l,e as u,a7 as ee,a8 as te,f as oe,g as S,h as le,O as ne,P as ae,m as se,v as re,x as ce,Q as ie,t as de,R as O,S as pe,q as I,z as ue,k as me,C as _e,D as fe}from"./index-DKVio5DX.js";import{i as W}from"./index-1zv9CzUI.js";import{i as ge}from"./index-JCBdu9eJ.js";import"./index-hd5M_H5A.js";import{E as be,a as he}from"./col-Ru1YGmP5.js";import{l as ve}from"./index--y5nxKK5.js";import{p as ye,r as xe}from"./index-3P7DVjiu.js";import{i as ke}from"./index-C8m5DZvo.js";const Te={__name:"search-form",emits:["search"],setup(r,{emit:n}){const a=n,f=d([]);ve().then(p=>{f.value=p}).catch(p=>{EleMessage.error(p.message)});const{form:m,resetFields:g}=A({softId:""}),b=()=>{a("search",m)},h=()=>{g(),b()};return(p,y)=>{const F=ee,x=te,k=oe,T=be,_=S,E=he,w=le,j=W;return D(),R(j,{"body-style":{paddingBottom:"2px"}},{default:t(()=>[l(w,{"label-width":"72px",onKeyup:J(b,["enter"])},{default:t(()=>[l(E,{gutter:8},{default:t(()=>[l(T,{lg:6,md:12,sm:12,xs:24},{default:t(()=>[l(k,{label:"软件名称",prop:"softId"},{default:t(()=>[l(x,{clearable:"",modelValue:$(m).softId,"onUpdate:modelValue":y[0]||(y[0]=o=>$(m).softId=o),placeholder:"不限",class:"ele-fluid"},{default:t(()=>[(D(!0),Z(X,null,Y(f.value,o=>(D(),R(F,{key:o.softId,value:o.softId,label:o.softName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(T,{lg:6,md:12,sm:12,xs:24},{default:t(()=>[l(k,{"label-width":"16px"},{default:t(()=>[l(_,{type:"primary",onClick:b},{default:t(()=>[u("查询")]),_:1}),l(_,{onClick:h},{default:t(()=>[u("重置")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},Ee={name:"ProjectNotice"},Ve=Object.assign(Ee,{setup(r){const{push:n}=ne(),{removePageTab:a}=ae(),f=d(null),m=d(""),g=se({}),b=re(()=>[{type:"selection",columnKey:"selection",width:50,align:"center",fixed:"left"},{prop:"noticeTop",label:"置顶",minWidth:60,align:"center",slot:"noticeTop"},{prop:"softName",label:"软件名称",minWidth:200},{slot:"noticeTitle",prop:"noticeTitle",label:"公告标题",minWidth:400},{prop:"createTime",label:"发布时间",minWidth:180},{columnKey:"action",label:"操作",width:130,align:"center",showOverflowTooltip:!1,resizable:!1,slot:"action",fixed:"right"}]),h=d([]),p=d(null),y=d(!0),F=d(!1);d(!0);const x=d(!0),k=({page:o,limit:e,where:s,orders:i,filters:C})=>ye(B(v(v(v({},s),i),C),{page:o,limit:e})),T=o=>{Object.assign(g,o),j()},_=o=>{var e,s;(s=(e=f.value)==null?void 0:e.reload)==null||s.call(e,{page:1,where:o})},E=o=>{const e=o?"/project/notice/edit":"/project/notice/add";a({key:e}),pe(()=>{n({path:e,query:o?{id:o.noticeId}:void 0})})},w=o=>{const e=o==null?h.value:[o];if(!e.length){I.error("请至少选择一条数据");return}ue.confirm("确定要删除“"+e.map(s=>s.noticeTitle).join(", ")+"”吗?","系统提示",{type:"warning",draggable:!0}).then(()=>{const s=I.loading("请求中..");xe(e.map(i=>i.noticeId)).then(i=>{s.close(),I.success(i),_()}).catch(i=>{s.close(),I.error(i.message)})}).catch(()=>{})},j=()=>{m.value?_(B(v({},g),{soft_name:m.value})):_(g)};return(o,e)=>{const s=S,i=me,C=_e,K=fe,M=ge,P=W,z=ke;return D(),R(z,{"hide-footer":"","flex-table":x.value,style:{"min-height":"600px"}},{default:t(()=>[l(Te,{onSearch:T}),l(P,{"body-style":{padding:"2px 10px 10px 10px"},"flex-table":x.value},{default:t(()=>[l(M,{ref_key:"tableRef",ref:f,"row-key":"noticeId",columns:b.value,datasource:k,current:p.value,"onUpdate:current":e[2]||(e[2]=c=>p.value=c),selections:h.value,"onUpdate:selections":e[3]||(e[3]=c=>h.value=c),"show-overflow-tooltip":!0,"highlight-current-row":"","row-click-checked":"",stripe:F.value,border:y.value,"default-sort":{prop:"createTime",order:"ascending"}},{toolbar:t(()=>[l(s,{type:"primary",icon:$(ce),class:"ele-btn-icon",onClick:e[0]||(e[0]=c=>E())},{default:t(()=>[u(" 添加 ")]),_:1},8,["icon"]),l(s,{type:"danger",class:"ele-btn-icon",icon:$(ie),onClick:e[1]||(e[1]=c=>w())},{default:t(()=>[u(" 删除 ")]),_:1},8,["icon"])]),noticeTop:t(({row:c})=>[l(i,{class:"ml-2",type:c.noticeTop_style,effect:"plain",size:"small"},{default:t(()=>[u(de(c.noticeTopType),1)]),_:2},1032,["type"])]),action:t(({row:c})=>[l(C,{type:"primary",underline:!1,onClick:O(U=>E(c),["stop"])},{default:t(()=>[u(" 修改 ")]),_:2},1032,["onClick"]),l(K,{direction:"vertical"}),l(C,{type:"danger",underline:!1,onClick:O(U=>w(c),["stop"])},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),_:1},8,["columns","current","selections","stripe","border"])]),_:1},8,["flex-table"])]),_:1},8,["flex-table"])}}});export{Ve as default};
