var O=Object.defineProperty,j=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var U=(p,s,u)=>s in p?O(p,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[s]=u,w=(p,s)=>{for(var u in s||(s={}))W.call(s,u)&&U(p,u,s[u]);if(F)for(var u of F(s))K.call(s,u)&&U(p,u,s[u]);return p},$=(p,s)=>j(p,L(s));import{r as x,u as B,o as k,c as A,w as e,a as G,b as r,F as H,G as q,p as J,d as l,e as a,a7 as Q,a8 as X,f as Y,W as Z,E as ee,g as M,h as le,i as te,t as d,a6 as C,j as D,k as S,l as oe,_ as ae,v as se,m as ne,R as re,C as ce}from"./index-DKVio5DX.js";import{i as P}from"./index-1zv9CzUI.js";import{i as ue}from"./index-JCBdu9eJ.js";import"./index-hd5M_H5A.js";import{E as de}from"./text-lzaRNwcJ.js";import{E as ie,a as pe}from"./col-Ru1YGmP5.js";import{l as me}from"./index--y5nxKK5.js";import{E as _e,a as fe}from"./descriptions-item-KgQ7D8Go.js";import{c as ge}from"./index-v5MNGS2a.js";import{i as be}from"./index-C8m5DZvo.js";const ye={__name:"search-form",emits:["search"],setup(p,{emit:s}){const u=s,v=x([]);me().then(y=>{v.value=y}).catch(y=>{EleMessage.error(y.message)});const{form:m,resetFields:h}=B({softId:void 0,logType:"",userAccount:""}),o=()=>{u("search",m)},E=()=>{h(),o()};return(y,f)=>{const I=Q,g=X,t=Y,V=ie,i=Z,c=ee,_=M,T=pe,z=le,N=P;return k(),A(N,{"body-style":{paddingBottom:"2px"}},{default:e(()=>[l(z,{"label-width":"72px",onKeyup:G(o,["enter"])},{default:e(()=>[l(T,{gutter:8},{default:e(()=>[l(V,{lg:6,md:12,sm:12,xs:24},{default:e(()=>[l(t,{label:"所属软件",prop:"softId"},{default:e(()=>[l(g,{clearable:"",modelValue:r(m).softId,"onUpdate:modelValue":f[0]||(f[0]=b=>r(m).softId=b),placeholder:"不限",class:"ele-fluid"},{default:e(()=>[(k(!0),J(H,null,q(v.value,b=>(k(),A(I,{key:b.softId,value:b.softId,label:b.softName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(V,{lg:6,md:12,sm:12,xs:24},{default:e(()=>[l(t,{label:"日志类型"},{default:e(()=>[l(i,{code:"soft_user_log_type",modelValue:r(m).logType,"onUpdate:modelValue":f[1]||(f[1]=b=>r(m).logType=b)},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{lg:6,md:12,sm:12,xs:24},{default:e(()=>[l(t,{label:"查询用户"},{default:e(()=>[l(c,{clearable:"",modelValue:r(m).userAccount,"onUpdate:modelValue":f[2]||(f[2]=b=>r(m).userAccount=b),modelModifiers:{trim:!0},placeholder:"输入要查询的账号/卡号"},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{lg:6,md:12,sm:12,xs:24},{default:e(()=>[l(t,{"label-width":"16px"},{default:e(()=>[l(_,{type:"primary",onClick:o},{default:e(()=>[a("查询")]),_:1}),l(_,{onClick:E},{default:e(()=>[a("重置")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},xe=D("br",null,null,-1),ve={__name:"log-info",props:{modelValue:Boolean,data:Object},emits:["done","update:modelValue"],setup(p,{emit:s}){const u=s,v=p,m=x(!1);x(!1);const h=x(null),{form:o,resetFields:E,assignFields:y}=B({logId:void 0,softId:"",userId:"",softName:"",userAccount:"",userEndtime:"",userPoint:"",softVer:"",logType:"",logType_style:"",userType:"",userType_style:"",logIp:"",logMac:"",logInfo:"",createTime:""}),f=I=>{u("update:modelValue",I)};return te(()=>v.modelValue,I=>{var g,t;I?v.data?(y($(w({},v.data),{password:""})),m.value=!0):m.value=!1:(E(),(t=(g=h.value)==null?void 0:g.clearValidate)==null||t.call(g))}),(I,g)=>{const t=_e,V=S,i=fe,c=M,_=oe;return k(),A(_,{form:"",style:{"word-break":"break-all"},width:640,"model-value":p.modelValue,title:"日志详情","onUpdate:modelValue":f},{footer:e(()=>[l(c,{onClick:g[0]||(g[0]=T=>f(!1))},{default:e(()=>[a("关闭")]),_:1})]),default:e(()=>[l(i,{class:"margin-top",column:"2",size:"small",border:""},{default:e(()=>[l(t,{label:r(o).userType,align:"center",span:2},{default:e(()=>[a(d(r(o).userAccount),1)]),_:1},8,["label"]),l(t,{label:"所属软件",align:"center",span:2},{default:e(()=>[a(d(r(o).softName)+" ",1),l(V,{class:"mx-1",type:"info",size:"small"},{default:e(()=>[a(d(r(o).softVer),1)]),_:1})]),_:1}),l(t,{label:"到期时间",align:"center",span:2},{default:e(()=>[a(d(r(o).userEndtime),1)]),_:1}),l(t,{label:"点数余额",align:"center",span:2},{default:e(()=>[a(d(r(o).userPoint),1)]),_:1}),l(t,{label:"日志类型",align:"center",span:2},{default:e(()=>[D("span",{class:"mx-1",style:C([{"text-decoration":"underline"},r(o).logType_style])},d(r(o).logType),5)]),_:1}),l(t,{label:"操作时间",align:"center",span:2},{default:e(()=>[a(d(r(o).createTime),1)]),_:1}),l(t,{label:"记录IP",align:"center",span:2},{default:e(()=>[a(d(r(o).logIp),1)]),_:1}),l(t,{label:"记录MAC",align:"center",span:2},{default:e(()=>[a(d(r(o).logMac),1)]),_:1})]),_:1}),xe,l(i,{direction:"vertical",column:"1",size:"small",border:""},{default:e(()=>[l(t,{label:"日志内容",align:"center"},{default:e(()=>[a(d(r(o).logInfo),1)]),_:1})]),_:1})]),_:1},8,["model-value"])}}},he={style:{"font-size":"13px"}},Ie={name:"AgentLog"},Ve=Object.assign(Ie,{setup(p){const s=x(null),u=se(()=>[{prop:"logId",label:"ID",align:"center",width:60},{prop:"userAccount",label:"账户 / 卡号",minWidth:180,slot:"userAccount"},{prop:"softName",label:"所属软件",width:180,slot:"softName"},{prop:"logType",label:"类型",width:90,align:"center",slot:"logType"},{prop:"logInfo",label:"详细日志",minWidth:400,slot:"logInfo"},{prop:"userEndtime",label:"到期时间",width:180,align:"center"},{prop:"userPoint",label:"点数余额",width:120,align:"center"},{prop:"logIp",label:"IP地址",width:160},{prop:"createTime",label:"操作时间",width:180},{columnKey:"action",label:"操作",width:80,align:"center",showOverflowTooltip:!1,resizable:!1,slot:"action",fixed:"right"}]),v=x([]),m=x(!0),h=x(null),o=ne({}),E=x(""),y=x(!1),f=i=>{h.value=i!=null?i:null,y.value=!0},I=i=>{Object.assign(o,i),g()},g=()=>{E.value?t(w({},o)):t(o)},t=i=>{var c,_;(_=(c=s.value)==null?void 0:c.reload)==null||_.call(c,{page:1,where:i})},V=({page:i,limit:c,where:_,orders:T})=>ge($(w(w({},_),T),{page:i,limit:c}));return(i,c)=>{const _=S,T=de,z=ce,N=ue,b=P,R=be;return k(),A(R,{"hide-footer":"","flex-table":m.value},{default:e(()=>[l(ye,{onSearch:I}),l(b,{"body-style":{padding:"10px 10px 10px 10px"},"flex-table":m.value},{default:e(()=>[l(N,{ref_key:"tableRef",ref:s,"row-key":"carmiId",columns:u.value,datasource:V,current:h.value,"onUpdate:current":c[0]||(c[0]=n=>h.value=n),selections:v.value,"onUpdate:selections":c[1]||(c[1]=n=>v.value=n),"show-overflow-tooltip":!0,"highlight-current-row":"",stripe:!1,border:!1,toolbar:!1,pagination:{pageSize:20,layout:"total, prev, pager, next, sizes"}},{userAccount:e(({row:n})=>[l(_,{class:"mx-1",style:C(n.userType_style),effect:"dark",size:"small"},{default:e(()=>[a(d(n.userType),1)]),_:2},1032,["style"]),a(" "+d(n.userAccount),1)]),softName:e(({row:n})=>[a(d(n.softName)+" ",1),l(_,{class:"mx-1",type:"info",size:"small"},{default:e(()=>[a(d(n.softVer),1)]),_:2},1024)]),logType:e(({row:n})=>[a(" ["),l(T,{class:"mx-1",style:C(n.logType_style)},{default:e(()=>[a(d(n.logType),1)]),_:2},1032,["style"]),a("] ")]),logInfo:e(({row:n})=>[D("span",he,d(n.logInfo),1)]),action:e(({row:n})=>[l(z,{type:"primary",underline:!1,onClick:re(Te=>f(n),["stop"])},{default:e(()=>[a(" 查看 ")]),_:2},1032,["onClick"])]),_:1},8,["columns","current","selections"])]),_:1},8,["flex-table"]),l(ve,{modelValue:y.value,"onUpdate:modelValue":c[2]||(c[2]=n=>y.value=n),data:h.value,onDone:t},null,8,["modelValue","data"])]),_:1},8,["flex-table"])}}}),Be=ae(Ve,[["__scopeId","data-v-532a22b3"]]);export{Be as default};
