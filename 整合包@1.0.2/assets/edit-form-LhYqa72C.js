var L=Object.defineProperty;var y=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var E=(m,t,s)=>t in m?L(m,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):m[t]=s,I=(m,t)=>{for(var s in t||(t={}))S.call(t,s)&&E(m,s,t[s]);if(y)for(var s of y(t))W.call(t,s)&&E(m,s,t[s]);return m};import{_ as $,O as A,P as J,r as _,m as k,u as K,i as Q,o as x,c as w,w as l,e as F,d as e,b as u,F as X,G as Y,p as Z,q as U,g as ee,f as le,a7 as ae,a8 as te,E as oe,W as se,h as ne}from"./index-DKVio5DX.js";import{E as re,a as ue}from"./col-Ru1YGmP5.js";import{i as de}from"./index-1zv9CzUI.js";import{B as me}from"./index-bSvVF2vt.js";import{z as ie,a as ce}from"./zh_Hans-LNKypXxg.js";import{g as pe,h as fe}from"./github-markdown-light--sWw-Hw4.js";import{u as _e}from"./index-94H0BTDC.js";import{u as ge,a as ve}from"./index-3P7DVjiu.js";import{l as be}from"./index--y5nxKK5.js";const xe={__name:"edit-form",props:{data:Object},setup(m){const t=m,{currentRoute:s,push:P}=A(),{removePageTab:h,reloadPageTab:B}=J();_(null);const C=k({locale:ie,plugins:[pe({locale:ce}),fe()],editorConfig:{lineNumbers:!0},uploadImages:o=>Promise.all(o.map(a=>new Promise((p,c)=>{_e(a).then(n=>{console.log("res:",n);const i={url:n.url,alt:n.name,title:n.name};p(i)}).catch(n=>{c(n)})})))}),v=_(!1),g=_(!1),b=_(null),V=_([]);be().then(o=>{V.value=o});const{form:d,resetFields:D,assignFields:O}=K({noticeId:void 0,noticeTitle:"",noticeInfo:"",softId:void 0,noticeType:"",noticeTop:""}),R=k({noticeTitle:[{required:!0,message:"请输入公告标题",type:"string",trigger:"blur"}],softId:[{required:!0,message:"请选择公告所属软件",type:"number",trigger:"blur"}]}),N=()=>{var o,a;(a=(o=b.value)==null?void 0:o.validate)==null||a.call(o,p=>{if(!p)return;g.value=!0,(v.value?ge:ve)(d).then(n=>{g.value=!1,U.success(n),q()}).catch(n=>{g.value=!1,U.error(n.message)})})},j=()=>{h({key:u(s).path}),P("/project/notice")},q=()=>{h({key:u(s).path}),B({fullPath:"/project/notice"})};return Q(()=>t.data,()=>{var o,a;t.data?(O(I({},t.data)),v.value=!0):(v.value=!1,D(),(a=(o=b.value)==null?void 0:o.clearValidate)==null||a.call(o))},{immediate:!0}),(o,a)=>{const p=ee,c=le,n=de,i=re,f=ae,T=te,z=oe,G=se,H=ue,M=ne;return x(),w(M,{ref_key:"formRef",ref:b,model:u(d),rules:R,"label-width":"80px"},{default:l(()=>[e(H,{gutter:10},{default:l(()=>[e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[e(n,null,{default:l(()=>[e(c,{style:{"margin-left":"-90px","margin-top":"-10px","margin-block":"-10px"}},{default:l(()=>[e(p,{type:"primary",loading:g.value,onClick:N},{default:l(()=>[F(" 保存 ")]),_:1},8,["loading"]),e(p,{onClick:j},{default:l(()=>[F("关闭")]),_:1})]),_:1})]),_:1})]),_:1}),e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[e(n,null,{default:l(()=>[e(i,{lg:24,md:24,sm:24,xs:24},{default:l(()=>[e(c,{label:"所属软件",prop:"softId"},{default:l(()=>[e(T,{clearable:"",modelValue:u(d).softId,"onUpdate:modelValue":a[0]||(a[0]=r=>u(d).softId=r),placeholder:"请选择公告所属软件",class:"ele-fluid"},{default:l(()=>[(x(!0),Z(X,null,Y(V.value,r=>(x(),w(f,{key:r.softId,value:r.softId,label:r.softName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{lg:24,md:24,sm:24,xs:24},{default:l(()=>[e(c,{label:"公告标题",prop:"noticeTitle"},{default:l(()=>[e(z,{clearable:"",maxlength:100,modelValue:u(d).noticeTitle,"onUpdate:modelValue":a[1]||(a[1]=r=>u(d).noticeTitle=r),"show-word-limit":"",placeholder:"请输入公告标题"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{lg:24,md:24,sm:24,xs:24},{default:l(()=>[e(c,{label:"置顶显示",prop:"noticeTop"},{default:l(()=>[e(G,{code:"top",modelValue:u(d).noticeTop,"onUpdate:modelValue":a[2]||(a[2]=r=>u(d).noticeTop=r),placeholder:"请选择是否置顶显示"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{lg:24,md:24,sm:24,xs:24},{default:l(()=>[e(c,{label:"标题颜色",prop:"noticeType"},{default:l(()=>[e(T,{clearable:"",modelValue:u(d).noticeType,"onUpdate:modelValue":a[3]||(a[3]=r=>u(d).noticeType=r),placeholder:"请选择标题颜色",class:"ele-fluid"},{default:l(()=>[e(f,{value:"",label:"默认"}),e(f,{value:"primary",label:"主题色"}),e(f,{value:"success",label:"绿色"}),e(f,{value:"warning",label:"黄色"}),e(f,{value:"danger",label:"红色"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{lg:24,md:24,sm:24,xs:24},{default:l(()=>[e(me,{modelValue:u(d).noticeInfo,"onUpdate:modelValue":a[4]||(a[4]=r=>u(d).noticeInfo=r),config:C,height:"600px"},null,8,["modelValue","config"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])}}},Pe=$(xe,[["__scopeId","data-v-3a7743c5"]]);export{Pe as E};
