var _e=Object.defineProperty,Fe=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var se=(t,o,e)=>o in t?_e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,U=(t,o)=>{for(var e in o||(o={}))we.call(o,e)&&se(t,e,o[e]);if(te)for(var e of te(o))Pe.call(o,e)&&se(t,e,o[e]);return t},O=(t,o)=>Fe(t,Le(o));var q=(t,o,e)=>new Promise((f,u)=>{var d=v=>{try{k(e.next(v))}catch(E){u(E)}},p=v=>{try{k(e.throw(v))}catch(E){u(E)}},k=v=>v.done?f(v.value):Promise.resolve(v.value).then(d,p);k((e=e.apply(t,o)).next())});import{cU as Se,bx as ee,bB as ve,cw as me,aA as H,aE as y,bb as J,cV as $,a9 as T,b7 as Ue,aB as K,cW as z,r as ye,v as Q,o as b,c as S,w as _,F as Oe,b as a,ag as g,a as ge,p as P,n as h,R as j,A as D,cX as Te,d as w,t as ae,j as M,a6 as Be,cA as De,cB as je,cC as Ae,cY as Ne,Q as qe,af as R,G as Me,cZ as Ke,aC as I,ba as He,c0 as Z,c_ as oe,bd as ze,c$ as Ie,c1 as Ve,d0 as Xe,i as ne,bm as Ge,br as We,bl as Ye,c3 as Je,aF as le,ad as re,aD as Qe}from"./index-DKVio5DX.js";import{E as Ze}from"./progress-5PMSkHEP.js";var xe=1,et=4;function ie(t){return Se(t,xe|et)}const be=Symbol("uploadContextKey"),tt="ElUpload";class st extends Error{constructor(o,e,f,u){super(o),this.name="UploadAjaxError",this.status=e,this.method=f,this.url=u}}function ue(t,o,e){let f;return e.response?f=`${e.response.error||e.response}`:e.responseText?f=`${e.responseText}`:f=`fail to ${o.method} ${t} ${e.status}`,new st(f,e.status,o.method,t)}function at(t){const o=t.responseText||t.response;if(!o)return o;try{return JSON.parse(o)}catch(e){return o}}const ot=t=>{typeof XMLHttpRequest=="undefined"&&ee(tt,"XMLHttpRequest is undefined");const o=new XMLHttpRequest,e=t.action;o.upload&&o.upload.addEventListener("progress",d=>{const p=d;p.percent=d.total>0?d.loaded/d.total*100:0,t.onProgress(p)});const f=new FormData;if(t.data)for(const[d,p]of Object.entries(t.data))ve(p)&&p.length?f.append(d,...p):f.append(d,p);f.append(t.filename,t.file,t.file.name),o.addEventListener("error",()=>{t.onError(ue(e,t,o))}),o.addEventListener("load",()=>{if(o.status<200||o.status>=300)return t.onError(ue(e,t,o));t.onSuccess(at(o))}),o.open(t.method,e,!0),t.withCredentials&&"withCredentials"in o&&(o.withCredentials=!0);const u=t.headers||{};if(u instanceof Headers)u.forEach((d,p)=>o.setRequestHeader(p,d));else for(const[d,p]of Object.entries(u))me(p)||o.setRequestHeader(d,String(p));return o.send(f),o},he=["text","picture","picture-card"];let nt=1;const x=()=>Date.now()+nt++,Ee=H({action:{type:String,default:"#"},headers:{type:y(Object)},method:{type:String,default:"post"},data:{type:y([Object,Function,Promise]),default:()=>J({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:y(Array),default:()=>J([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:he,default:"text"},httpRequest:{type:y(Function),default:ot},disabled:Boolean,limit:Number}),lt=H(O(U({},Ee),{beforeUpload:{type:y(Function),default:$},beforeRemove:{type:y(Function)},onRemove:{type:y(Function),default:$},onChange:{type:y(Function),default:$},onPreview:{type:y(Function),default:$},onSuccess:{type:y(Function),default:$},onProgress:{type:y(Function),default:$},onError:{type:y(Function),default:$},onExceed:{type:y(Function),default:$}})),rt=H({files:{type:y(Array),default:()=>J([])},disabled:{type:Boolean,default:!1},handlePreview:{type:y(Function),default:$},listType:{type:String,values:he,default:"text"}}),it={remove:t=>!!t},ut=["onKeydown"],dt=["src"],ct=["onClick"],ft=["title"],pt=["onClick"],vt=["onClick"],mt=T({name:"ElUploadList"}),yt=T(O(U({},mt),{props:rt,emits:it,setup(t,{emit:o}){const e=t,{t:f}=Ue(),u=K("upload"),d=K("icon"),p=K("list"),k=z(),v=ye(!1),E=Q(()=>[u.b("list"),u.bm("list",e.listType),u.is("disabled",e.disabled)]),C=m=>{o("remove",m)};return(m,l)=>(b(),S(Ke,{tag:"ul",class:g(a(E)),name:a(p).b()},{default:_(()=>[(b(!0),P(Oe,null,Me(m.files,s=>(b(),P("li",{key:s.uid||s.name,class:g([a(u).be("list","item"),a(u).is(s.status),{focusing:v.value}]),tabindex:"0",onKeydown:ge(i=>!a(k)&&C(s),["delete"]),onFocus:l[0]||(l[0]=i=>v.value=!0),onBlur:l[1]||(l[1]=i=>v.value=!1),onClick:l[2]||(l[2]=i=>v.value=!1)},[R(m.$slots,"default",{file:s},()=>[m.listType==="picture"||s.status!=="uploading"&&m.listType==="picture-card"?(b(),P("img",{key:0,class:g(a(u).be("list","item-thumbnail")),src:s.url,alt:""},null,10,dt)):h("v-if",!0),s.status==="uploading"||m.listType!=="picture-card"?(b(),P("div",{key:1,class:g(a(u).be("list","item-info"))},[M("a",{class:g(a(u).be("list","item-name")),onClick:j(i=>m.handlePreview(s),["prevent"])},[w(a(D),{class:g(a(d).m("document"))},{default:_(()=>[w(a(Te))]),_:1},8,["class"]),M("span",{class:g(a(u).be("list","item-file-name")),title:s.name},ae(s.name),11,ft)],10,ct),s.status==="uploading"?(b(),S(a(Ze),{key:0,type:m.listType==="picture-card"?"circle":"line","stroke-width":m.listType==="picture-card"?6:2,percentage:Number(s.percentage),style:Be(m.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):h("v-if",!0)],2)):h("v-if",!0),M("label",{class:g(a(u).be("list","item-status-label"))},[m.listType==="text"?(b(),S(a(D),{key:0,class:g([a(d).m("upload-success"),a(d).m("circle-check")])},{default:_(()=>[w(a(De))]),_:1},8,["class"])):["picture-card","picture"].includes(m.listType)?(b(),S(a(D),{key:1,class:g([a(d).m("upload-success"),a(d).m("check")])},{default:_(()=>[w(a(je))]),_:1},8,["class"])):h("v-if",!0)],2),a(k)?h("v-if",!0):(b(),S(a(D),{key:2,class:g(a(d).m("close")),onClick:i=>C(s)},{default:_(()=>[w(a(Ae))]),_:2},1032,["class","onClick"])),h(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),h(" This is a bug which needs to be fixed "),h(" TODO: Fix the incorrect navigation interaction "),a(k)?h("v-if",!0):(b(),P("i",{key:3,class:g(a(d).m("close-tip"))},ae(a(f)("el.upload.deleteTip")),3)),m.listType==="picture-card"?(b(),P("span",{key:4,class:g(a(u).be("list","item-actions"))},[M("span",{class:g(a(u).be("list","item-preview")),onClick:i=>m.handlePreview(s)},[w(a(D),{class:g(a(d).m("zoom-in"))},{default:_(()=>[w(a(Ne))]),_:1},8,["class"])],10,pt),a(k)?h("v-if",!0):(b(),P("span",{key:0,class:g(a(u).be("list","item-delete")),onClick:i=>C(s)},[w(a(D),{class:g(a(d).m("delete"))},{default:_(()=>[w(a(qe))]),_:1},8,["class"])],10,vt))],2)):h("v-if",!0)])],42,ut))),128)),R(m.$slots,"append")]),_:3},8,["class","name"]))}}));var de=I(yt,[["__file","upload-list.vue"]]);const gt=H({disabled:{type:Boolean,default:!1}}),bt={file:t=>ve(t)},ht=["onDrop","onDragover"],ke="ElUploadDrag",Et=T({name:ke}),kt=T(O(U({},Et),{props:gt,emits:bt,setup(t,{emit:o}){const e=He(be);e||ee(ke,"usage: <el-upload><el-upload-dragger /></el-upload>");const f=K("upload"),u=ye(!1),d=z(),p=v=>{if(d.value)return;u.value=!1,v.stopPropagation();const E=Array.from(v.dataTransfer.files),C=e.accept.value;if(!C){o("file",E);return}const m=E.filter(l=>{const{type:s,name:i}=l,n=i.includes(".")?`.${i.split(".").pop()}`:"",c=s.replace(/\/.*$/,"");return C.split(",").map(r=>r.trim()).filter(r=>r).some(r=>r.startsWith(".")?n===r:/\/\*$/.test(r)?c===r.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(r)?s===r:!1)});o("file",m)},k=()=>{d.value||(u.value=!0)};return(v,E)=>(b(),P("div",{class:g([a(f).b("dragger"),a(f).is("dragover",u.value)]),onDrop:j(p,["prevent"]),onDragover:j(k,["prevent"]),onDragleave:E[0]||(E[0]=j(C=>u.value=!1,["prevent"]))},[R(v.$slots,"default")],42,ht))}}));var $t=I(kt,[["__file","upload-dragger.vue"]]);const Ct=H(O(U({},Ee),{beforeUpload:{type:y(Function),default:$},onRemove:{type:y(Function),default:$},onStart:{type:y(Function),default:$},onSuccess:{type:y(Function),default:$},onProgress:{type:y(Function),default:$},onError:{type:y(Function),default:$},onExceed:{type:y(Function),default:$}})),Rt=["onKeydown"],_t=["name","multiple","accept"],Ft=T({name:"ElUploadContent",inheritAttrs:!1}),Lt=T(O(U({},Ft),{props:Ct,setup(t,{expose:o}){const e=t,f=K("upload"),u=z(),d=Z({}),p=Z(),k=n=>{if(n.length===0)return;const{autoUpload:c,limit:r,fileList:F,multiple:L,onStart:A,onExceed:V}=e;if(r&&F.length+n.length>r){V(n,F);return}L||(n=n.slice(0,1));for(const X of n){const N=X;N.uid=x(),A(N),c&&v(N)}},v=n=>q(this,null,function*(){if(p.value.value="",!e.beforeUpload)return C(n);let c,r={};try{const L=e.data,A=e.beforeUpload(n);r=oe(e.data)?ie(e.data):e.data,c=yield A,oe(e.data)&&ze(L,r)&&(r=ie(e.data))}catch(L){c=!1}if(c===!1){e.onRemove(n);return}let F=n;c instanceof Blob&&(c instanceof File?F=c:F=new File([c],n.name,{type:n.type})),C(Object.assign(F,{uid:n.uid}),r)}),E=(n,c)=>q(this,null,function*(){return Ve(n)?n(c):n}),C=(n,c)=>q(this,null,function*(){const{headers:r,data:F,method:L,withCredentials:A,name:V,action:X,onProgress:N,onSuccess:$e,onError:Ce,httpRequest:Re}=e;try{c=yield E(c!=null?c:F,n)}catch(B){e.onRemove(n);return}const{uid:G}=n,W={headers:r||{},withCredentials:A,file:n,data:c,method:L,filename:V,action:X,onProgress:B=>{N(B,n)},onSuccess:B=>{$e(B,n),delete d.value[G]},onError:B=>{Ce(B,n),delete d.value[G]}},Y=Re(W);d.value[G]=Y,Y instanceof Promise&&Y.then(W.onSuccess,W.onError)}),m=n=>{const c=n.target.files;c&&k(Array.from(c))},l=()=>{u.value||(p.value.value="",p.value.click())},s=()=>{l()};return o({abort:n=>{Ie(d.value).filter(n?([r])=>String(n.uid)===r:()=>!0).forEach(([r,F])=>{F instanceof XMLHttpRequest&&F.abort(),delete d.value[r]})},upload:v}),(n,c)=>(b(),P("div",{class:g([a(f).b(),a(f).m(n.listType),a(f).is("drag",n.drag)]),tabindex:"0",onClick:l,onKeydown:ge(j(s,["self"]),["enter","space"])},[n.drag?(b(),S($t,{key:0,disabled:a(u),onFile:k},{default:_(()=>[R(n.$slots,"default")]),_:3},8,["disabled"])):R(n.$slots,"default",{key:1}),M("input",{ref_key:"inputRef",ref:p,class:g(a(f).e("input")),name:n.name,multiple:n.multiple,accept:n.accept,type:"file",onChange:m,onClick:c[0]||(c[0]=j(()=>{},["stop"]))},null,42,_t)],42,Rt))}}));var ce=I(Lt,[["__file","upload-content.vue"]]);const fe="ElUpload",pe=t=>{var o;(o=t.url)!=null&&o.startsWith("blob:")&&URL.revokeObjectURL(t.url)},wt=(t,o)=>{const e=Xe(t,"fileList",void 0,{passive:!0}),f=l=>e.value.find(s=>s.uid===l.uid);function u(l){var s;(s=o.value)==null||s.abort(l)}function d(l=["ready","uploading","success","fail"]){e.value=e.value.filter(s=>!l.includes(s.status))}const p=(l,s)=>{const i=f(s);i&&(console.error(l),i.status="fail",e.value.splice(e.value.indexOf(i),1),t.onError(l,i,e.value),t.onChange(i,e.value))},k=(l,s)=>{const i=f(s);i&&(t.onProgress(l,i,e.value),i.status="uploading",i.percentage=Math.round(l.percent))},v=(l,s)=>{const i=f(s);i&&(i.status="success",i.response=l,t.onSuccess(l,i,e.value),t.onChange(i,e.value))},E=l=>{me(l.uid)&&(l.uid=x());const s={name:l.name,percentage:0,status:"ready",size:l.size,raw:l,uid:l.uid};if(t.listType==="picture-card"||t.listType==="picture")try{s.url=URL.createObjectURL(l)}catch(i){Ge(fe,i.message),t.onError(i,s,e.value)}e.value=[...e.value,s],t.onChange(s,e.value)},C=l=>q(void 0,null,function*(){const s=l instanceof File?f(l):l;s||ee(fe,"file to be removed not found");const i=n=>{u(n);const c=e.value;c.splice(c.indexOf(n),1),t.onRemove(n,c),pe(n)};t.beforeRemove?(yield t.beforeRemove(s,e.value))!==!1&&i(s):i(s)});function m(){e.value.filter(({status:l})=>l==="ready").forEach(({raw:l})=>{var s;return l&&((s=o.value)==null?void 0:s.upload(l))})}return ne(()=>t.listType,l=>{l!=="picture-card"&&l!=="picture"||(e.value=e.value.map(s=>{const{raw:i,url:n}=s;if(!n&&i)try{s.url=URL.createObjectURL(i)}catch(c){t.onError(c,s,e.value)}return s}))}),ne(e,l=>{for(const s of l)s.uid||(s.uid=x()),s.status||(s.status="success")},{immediate:!0,deep:!0}),{uploadFiles:e,abort:u,clearFiles:d,handleError:p,handleProgress:k,handleStart:E,handleSuccess:v,handleRemove:C,submit:m,revokeFileObjectURL:pe}},Pt=T({name:"ElUpload"}),St=T(O(U({},Pt),{props:lt,setup(t,{expose:o}){const e=t,f=z(),u=Z(),{abort:d,submit:p,clearFiles:k,uploadFiles:v,handleStart:E,handleError:C,handleRemove:m,handleSuccess:l,handleProgress:s,revokeFileObjectURL:i}=wt(e,u),n=Q(()=>e.listType==="picture-card"),c=Q(()=>O(U({},e),{fileList:v.value,onStart:E,onProgress:s,onSuccess:l,onError:C,onRemove:m}));return We(()=>{v.value.forEach(i)}),Ye(be,{accept:Je(e,"accept")}),o({abort:d,submit:p,clearFiles:k,handleStart:E,handleRemove:m}),(r,F)=>(b(),P("div",null,[a(n)&&r.showFileList?(b(),S(de,{key:0,disabled:a(f),"list-type":r.listType,files:a(v),"handle-preview":r.onPreview,onRemove:a(m)},le({append:_(()=>[w(ce,re({ref_key:"uploadRef",ref:u},a(c)),{default:_(()=>[r.$slots.trigger?R(r.$slots,"trigger",{key:0}):h("v-if",!0),!r.$slots.trigger&&r.$slots.default?R(r.$slots,"default",{key:1}):h("v-if",!0)]),_:3},16)]),_:2},[r.$slots.file?{name:"default",fn:_(({file:L})=>[R(r.$slots,"file",{file:L})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):h("v-if",!0),!a(n)||a(n)&&!r.showFileList?(b(),S(ce,re({key:1,ref_key:"uploadRef",ref:u},a(c)),{default:_(()=>[r.$slots.trigger?R(r.$slots,"trigger",{key:0}):h("v-if",!0),!r.$slots.trigger&&r.$slots.default?R(r.$slots,"default",{key:1}):h("v-if",!0)]),_:3},16)):h("v-if",!0),r.$slots.trigger?R(r.$slots,"default",{key:2}):h("v-if",!0),R(r.$slots,"tip"),!a(n)&&r.showFileList?(b(),S(de,{key:3,disabled:a(f),"list-type":r.listType,files:a(v),"handle-preview":r.onPreview,onRemove:a(m)},le({_:2},[r.$slots.file?{name:"default",fn:_(({file:L})=>[R(r.$slots,"file",{file:L})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):h("v-if",!0)]))}}));var Ut=I(St,[["__file","upload.vue"]]);const Dt=Qe(Ut);export{Dt as E};
